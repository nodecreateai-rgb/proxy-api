services:
    cli-proxy-api:
        image: ${CLI_PROXY_IMAGE:-eceasy/cli-proxy-api:latest}
        pull_policy: always
        build:
            context: .
            dockerfile: Dockerfile
            args:
                VERSION: ${VERSION:-dev}
                COMMIT: ${COMMIT:-none}
                BUILD_DATE: ${BUILD_DATE:-unknown}
        container_name: cli-proxy-api
        environment:
            DEPLOY: ${DEPLOY:-}
            SECRET_KEY: ${SECRET_KEY:-}
            SORA_BASE_URL: ${SORA_BASE_URL:-}
            API_KEY_1: ${API_KEY_1:-}
            API_KEY_2: ${API_KEY_2:-}
        ports:
            - "8317:8317"
            - "8085:8085"
            - "1455:1455"
            - "54545:54545"
            - "51121:51121"
            - "11451:11451"
        volumes:
            - ./config.example.yaml:/CLIProxyAPI/config.example.yaml:ro
            - ./entrypoint.sh:/entrypoint.sh:ro
            - cli-proxy-api-auths:/root/.cli-proxy-api
            - ./logs:/CLIProxyAPI/logs
        entrypoint: ["sh", "/entrypoint.sh"]
        command: ["./CLIProxyAPI"]
        restart: unless-stopped

volumes:
    cli-proxy-api-auths:
        driver: local
